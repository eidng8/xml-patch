<!doctype html>
<html class="default no-js">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>g8-xml-patch</title>
	<meta name="description" content="">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link href="https://fonts.googleapis.com/css?family=Noto+Sans&display=swap" rel="stylesheet">
	<link rel="stylesheet" href="assets/css/main.css">
</head>
<body>
<header>
	<div class="tsd-page-toolbar">
		<div class="container">
			<div class="table-wrap">
				<div class="table-cell" id="tsd-search" data-index="assets/js/search.js" data-base=".">
					<div class="field">
						<label for="tsd-search-field" class="tsd-widget search no-caption">Search</label>
						<input id="tsd-search-field" type="text" />
					</div>
					<ul class="results">
						<li class="state loading">Preparing search index...</li>
						<li class="state failure">The search index is not available</li>
					</ul>
					<a href="index.html" class="title">g8-xml-patch</a>
				</div>
				<div class="table-cell" id="tsd-widgets">
					<div id="tsd-filter">
						<a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a>
						<div class="tsd-filter-group">
							<div class="tsd-select" id="tsd-filter-visibility">
								<span class="tsd-select-label">All</span>
								<ul class="tsd-select-list">
									<li data-value="public">Public</li>
									<li data-value="protected">Public/Protected</li>
									<li data-value="private" class="selected">All</li>
								</ul>
							</div>
							<input type="checkbox" id="tsd-filter-inherited" checked />
							<label class="tsd-widget" for="tsd-filter-inherited">Inherited</label>
						</div>
					</div>
					<a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a>
				</div>
			</div>
		</div>
	</div>
	<div class="tsd-page-title">
		<div class="container">
			<ul class="tsd-breadcrumb">
				<li>
					<a href="globals.html">Globals</a>
				</li>
			</ul>
		</div>
	</div>
</header>
<div class="container">
	<div class="row container container-main">
		<div class="col-3 col-menu menu-sticky-wrap menu-highlight">
			<nav class="tsd-navigation secondary menu-sticky">
				<ul>
					<li>📑 Index</li>
					<li><br></li>
					<li class=" ">
						<a href="globals.html">Globals</a>
						</li>                        <li class=" tsd-kind-module">
						<a href="modules/_errors_exception_.html">&quot;errors/<wbr>Exception&quot;</a>
						</li>                        <li class=" tsd-kind-module">
						<a href="modules/_errors_exceptionbag_.html">&quot;errors/<wbr>Exception<wbr>Bag&quot;</a>
						</li>                        <li class=" tsd-kind-module">
						<a href="modules/_errors_invalidattributevalue_.html">&quot;errors/<wbr>Invalid<wbr>Attribute<wbr>Value&quot;</a>
						</li>                        <li class=" tsd-kind-module">
						<a href="modules/_errors_invalidcharacterset_.html">&quot;errors/<wbr>Invalid<wbr>Character<wbr>Set&quot;</a>
						</li>                        <li class=" tsd-kind-module">
						<a href="modules/_errors_invaliddiffformat_.html">&quot;errors/<wbr>Invalid<wbr>Diff<wbr>Format&quot;</a>
						</li>                        <li class=" tsd-kind-module">
						<a href="modules/_errors_invalidentitydeclaration_.html">&quot;errors/<wbr>Invalid<wbr>Entity<wbr>Declaration&quot;</a>
						</li>                        <li class=" tsd-kind-module">
						<a href="modules/_errors_invalidnamespaceprefix_.html">&quot;errors/<wbr>Invalid<wbr>Namespace<wbr>Prefix&quot;</a>
						</li>                        <li class=" tsd-kind-module">
						<a href="modules/_errors_invalidnamespaceuri_.html">&quot;errors/<wbr>Invalid<wbr>NamespaceURI&quot;</a>
						</li>                        <li class=" tsd-kind-module">
						<a href="modules/_errors_invalidnodetypes_.html">&quot;errors/<wbr>Invalid<wbr>Node<wbr>Types&quot;</a>
						</li>                        <li class=" tsd-kind-module">
						<a href="modules/_errors_invalidpatchdirective_.html">&quot;errors/<wbr>Invalid<wbr>Patch<wbr>Directive&quot;</a>
						</li>                        <li class=" tsd-kind-module">
						<a href="modules/_errors_invalidprologoperation_.html">&quot;errors/<wbr>Invalid<wbr>Prolog<wbr>Operation&quot;</a>
						</li>                        <li class=" tsd-kind-module">
						<a href="modules/_errors_invalidrootelementoperation_.html">&quot;errors/<wbr>Invalid<wbr>Root<wbr>Element<wbr>Operation&quot;</a>
						</li>                        <li class=" tsd-kind-module">
						<a href="modules/_errors_invalidwhitespacedirective_.html">&quot;errors/<wbr>Invalid<wbr>Whitespace<wbr>Directive&quot;</a>
						</li>                        <li class=" tsd-kind-module">
						<a href="modules/_errors_unlocatednode_.html">&quot;errors/<wbr>Unlocated<wbr>Node&quot;</a>
						</li>                        <li class=" tsd-kind-module">
						<a href="modules/_errors_unsupportedidfunction_.html">&quot;errors/<wbr>Unsupported<wbr>IdFunction&quot;</a>
						</li>                        <li class=" tsd-kind-module">
						<a href="modules/_errors_unsupportedxmlid_.html">&quot;errors/<wbr>Unsupported<wbr>Xml<wbr>Id&quot;</a>
						</li>                        <li class=" tsd-kind-module">
						<a href="modules/_errors_helpers_.html">&quot;errors/helpers&quot;</a>
						</li>                        <li class=" tsd-kind-module">
						<a href="modules/_index_.html">&quot;index&quot;</a>
						</li>                        <li class=" tsd-kind-module">
						<a href="modules/_patch_action_.html">&quot;patch/action&quot;</a>
						</li>                        <li class=" tsd-kind-module">
						<a href="modules/_patch_action_add_.html">&quot;patch/action-<wbr>add&quot;</a>
						</li>                        <li class=" tsd-kind-module">
						<a href="modules/_patch_action_remove_.html">&quot;patch/action-<wbr>remove&quot;</a>
						</li>                        <li class=" tsd-kind-module">
						<a href="modules/_patch_action_replace_.html">&quot;patch/action-<wbr>replace&quot;</a>
						</li>                        <li class=" tsd-kind-module">
						<a href="modules/_patch_compiler_.html">&quot;patch/compiler&quot;</a>
						</li>                        <li class=" tsd-kind-module">
						<a href="modules/_patch_namespace_mangler_.html">&quot;patch/namespace-<wbr>mangler&quot;</a>
						</li>                        <li class=" tsd-kind-module">
						<a href="modules/_patch_patch_.html">&quot;patch/patch&quot;</a>
						</li>                        <li class=" tsd-kind-module">
						<a href="modules/_translations_zh_chs_.html">&quot;translations/zh_<wbr>chs&quot;</a>
						</li>                        <li class=" tsd-kind-module">
						<a href="modules/_translations_zh_cht_.html">&quot;translations/zh_<wbr>cht&quot;</a>
						</li>                        <li class=" tsd-kind-module">
						<a href="modules/_utils_asserts_.html">&quot;utils/asserts&quot;</a>
						</li>                        <li class=" tsd-kind-module">
						<a href="modules/_utils_helpers_.html">&quot;utils/helpers&quot;</a>
						</li>                        <li class=" tsd-kind-module">
						<a href="modules/_utils_type_guards_.html">&quot;utils/type-<wbr>guards&quot;</a>
						</li>                        <li class=" tsd-kind-module">
						<a href="modules/_xml_format_options_.html">&quot;xml/format-<wbr>options&quot;</a>
						</li>                        <li class=" tsd-kind-module">
						<a href="modules/_xml_xml_file_.html">&quot;xml/xml-<wbr>file&quot;</a>
						</li>                        <li class=" tsd-kind-module">
						<a href="modules/_xml_xml_file_options_.html">&quot;xml/xml-<wbr>file-<wbr>options&quot;</a>
						</li>                        <li class=" tsd-kind-module">
						<a href="modules/_xml_xml_options_.html">&quot;xml/xml-<wbr>options&quot;</a>
						</li>                        <li class=" tsd-kind-module">
						<a href="modules/_xml_xml_wrapper_.html">&quot;xml/xml-<wbr>wrapper&quot;</a>
				</li>                </ul>
			</nav>
		</div>
		<div class="col-9 col-content">
			<div class="tsd-panel">
				<a href="#xml-patch" id="xml-patch" style="color: inherit; text-decoration: none;">
					<h1>XML Patch</h1>
				</a>
				<p><a href="https://travis-ci.com/eidng8/xml-patch"><img src="https://img.shields.io/travis/com/eidng8/xml-patch?color=333&logo=travis" alt="master build"></a> <a href="https://snyk.io/test/github/eidng8/xml-patch?targetFile=package.json"><img src="https://img.shields.io/snyk/vulnerabilities/github/eidng8/xml-patch?color=333&logo=snyk" alt="vulnerabilities"></a> <a href="https://codeclimate.com/github/eidng8/xml-patch/maintainability"><img src="https://img.shields.io/codeclimate/maintainability/eidng8/xml-patch?color=333&logo=code-climate" alt="maintainability"></a> <a href="https://coveralls.io/github/eidng8/xml-patch?branch=master"><img src="https://img.shields.io/coveralls/github/eidng8/xml-patch/master?color=333&logo=coveralls" alt="master coverage"></a> <a href="https://travis-ci.com/eidng8/xml-patch/tree/dev"><img src="https://img.shields.io/travis/com/eidng8/xml-patch/dev?color=333&label=dev%20build&logo=travis" alt="dev build"></a> <a href="https://coveralls.io/github/eidng8/xml-patch?branch=dev"><img src="https://img.shields.io/coveralls/github/eidng8/xml-patch/dev?color=333&label=dev%20coverage&logo=coveralls" alt="dev coverage"></a></p>
				<p>This library provides functionalities to apply XML patch. It is supposed to be <a href="https://tools.ietf.org/html/rfc5261">RFC 5261</a> compliant.</p>
				<a href="#how-to-use" id="how-to-use" style="color: inherit; text-decoration: none;">
					<h2>How to use</h2>
				</a>
				<pre><code class="language-bash">npm i -S g8-xml-patch</code></pre>
				<a href="#javascript" id="javascript" style="color: inherit; text-decoration: none;">
					<h4>JavaScript</h4>
				</a>
				<pre><code class="language-js"><span class="hljs-keyword">const</span> XmlPatch = <span class="hljs-built_in">require</span>(<span class="hljs-string">'xml-patch'</span>);

<span class="hljs-built_in">console</span>.log(
  <span class="hljs-string">'This document: &lt;a&gt;&lt;b/&gt;&lt;/a&gt; will be patched to:\n'</span>,
  <span class="hljs-keyword">new</span> XmlPatch.Patch(<span class="hljs-string">'&lt;diff&gt;&lt;add sel="a/b"&gt;&lt;c/&gt;&lt;/add&gt;&lt;/diff&gt;'</span>)
    .apply(<span class="hljs-string">'&lt;a&gt;&lt;b/&gt;&lt;/a&gt;'</span>)
    .toString(),
);

<span class="hljs-keyword">try</span> {
  <span class="hljs-keyword">new</span> XmlPatch.Patch().load(<span class="hljs-string">'&lt;diff&gt;&lt;b/&gt;&lt;/diff&gt;'</span>);
} <span class="hljs-keyword">catch</span> (ex) {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'\nAnd here comes the expected error:\n'</span>, ex.toString());
}</code></pre>
				<a href="#typescript" id="typescript" style="color: inherit; text-decoration: none;">
					<h4>TypeScript</h4>
				</a>
				<pre><code class="language-ts"><span class="hljs-keyword">import</span> { Patch } <span class="hljs-keyword">from</span> <span class="hljs-string">'xml-patch'</span>;

<span class="hljs-built_in">console</span>.log(
  <span class="hljs-string">'This document: &lt;a&gt;&lt;b/&gt;&lt;/a&gt; will be patched to:\n'</span>,
  <span class="hljs-keyword">new</span> Patch()
    .load(<span class="hljs-string">'&lt;diff&gt;&lt;add sel="a/b"&gt;&lt;c/&gt;&lt;/add&gt;&lt;/diff&gt;'</span>)
    .apply(<span class="hljs-string">'&lt;a&gt;&lt;b/&gt;&lt;/a&gt;'</span>)
    .toString(),
);

<span class="hljs-keyword">try</span> {
  <span class="hljs-keyword">new</span> Patch(<span class="hljs-string">'&lt;diff&gt;&lt;b/&gt;&lt;/diff&gt;'</span>);
} <span class="hljs-keyword">catch</span> (ex) {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'\nAnd here comes the expected error:\n'</span>, ex.toString());
}</code></pre>
				<a href="#known-issues" id="known-issues" style="color: inherit; text-decoration: none;">
					<h2>Known issues</h2>
				</a>
				<ol>
					<li><p>It is tested with some commonly used XPath queries. However, XPath could be written in complexity beyond the capability of this library. In such circumstances, this library could raise error, or in worse scenarios it may behave unexpected.</p>
					</li>
					<li><p>Due to various reasons, there are a few errors defined in the RFC document, which will not be thrown at all. It doesn&#39;t mean those errors won&#39;t exist in XML documents, it&#39;s just they couldn&#39;t be detected by this library, or is interpreted differently and translated into other errors. These errors are: _ InvalidNamespaceURI (<invalid-namespace-uri>) _ InvalidPrologOperation (<invalid-prolog-operation>) _ UnsupportedIdFunction (<unsupported-id-function>) _ UnsupportedXmlId (<unsupported-xml-id>)</p>
					</li>
				</ol>
				<a href="#deviations-from-rfc-5261" id="deviations-from-rfc-5261" style="color: inherit; text-decoration: none;">
					<h2>Deviations from RFC 5261</h2>
				</a>
				<p>This library provides a mechanism to suppress exception throwing. One can define a callback function to handle suppressed exceptions.</p>
				<a href="#suppressing-exceptions" id="suppressing-exceptions" style="color: inherit; text-decoration: none;">
					<h3>Suppressing exceptions</h3>
				</a>
				<a href="#ignoreexceptionsexceptionsnewexception--newexception" id="ignoreexceptionsexceptionsnewexception--newexception" style="color: inherit; text-decoration: none;">
					<h5><code>ignoreExceptions(...exceptions:{new():Exception}[] | {new():Exception}[][])</code></h5>
				</a>
				<p>The <code>ignoreExceptions()</code> global function accepts a list of exceptions to be suppressed. Please note that exceptions that were not listed in the call will <strong><em>not</em></strong> be suppressed. Once suppressed, the corresponding error will be ignored, and the process of related operation <strong><em>may or may not</em></strong> go as usual depending on the nature of the error.</p>
				<ul>
					<li>If the error is crucial to the process or the RFC description, related process will be skipped for the occurring target node or action directive.</li>
					<li>If the error is not crucial, or RFC doesn&#39;t provide a clear definition, related process will be performed.</li>
				</ul>
				<a href="#dontignoreexceptions" id="dontignoreexceptions" style="color: inherit; text-decoration: none;">
					<h5><code>dontIgnoreExceptions()</code></h5>
				</a>
				<p>The <code>dontIgnoreExceptions()</code> global function simply cancels all suppression from the point of invocation forward.</p>
				<a href="#handling-suppressed-exceptions" id="handling-suppressed-exceptions" style="color: inherit; text-decoration: none;">
					<h3>Handling suppressed exceptions</h3>
				</a>
				<a href="#setexceptionhandlerhandlerexceptionhandler" id="setexceptionhandlerhandlerexceptionhandler" style="color: inherit; text-decoration: none;">
					<h5><code>setExceptionHandler(handler:ExceptionHandler)</code></h5>
				</a>
				<p>The <code>setExceptionHandler()</code> global function accepts a callback function, which will be invoked when error occurs and <strong><em>were suppressed</em></strong>. The callback will be invoked with the exception that would have been thrown if weren&#39;t suppressed. However, the return value of the callback function will be ignored. There will be no way for the callback function to affect the flow of process, except throwing an error to break the program.</p>
				<a href="#side-effects-of-exception-suppression" id="side-effects-of-exception-suppression" style="color: inherit; text-decoration: none;">
					<h3>Side effects of exception suppression</h3>
				</a>
				<p>As mentioned above, the flow of program may or may not go as usual when errors occur and were suppressed. The behavior introduces a number of side effects, and deviates from the original RFC document.</p>
				<ul>
					<li>When <code>InvalidNodeTypes</code> (<code>&lt;invalid-node-types&gt;</code>) is suppressed, it will be possible to replace a target node with multiple nodes.</li>
					<li>When <code>UnlocatedNode</code> (<code>&lt;unlocated-node&gt;</code>) is suppressed,<ul>
							<li>it will be possible to target multiple nodes with the <code>sel</code> attribute.</li>
							<li><code>sel</code> may yield no match, so the directive will have no effect</li>
						</ul>
					</li>
					<li>Combining the above two cases, it will be possible to target multiple nodes, and operate with the same set of nodes provided by a single directive.</li>
					<li>When <code>InvalidWhitespaceDirective</code> (<code>&lt;invalid-whitespace-directive&gt;</code>) is suppressed, directives with <code>ws</code> attribute will only remove white space nodes whenever applicable.</li>
					<li>When <code>InvalidNodeTypes</code> (<code>&lt;invalid-node-types&gt;</code>) is suppressed, it will be possible to replace nodes with different types. Say, replacing an element node with text node.</li>
				</ul>
				<p>Please note that the above list is not exhaustive. There may be other side effects haven&#39;t been defined or noticed yet.</p>
				<a href="#messages-translations" id="messages-translations" style="color: inherit; text-decoration: none;">
					<h2>Messages translations</h2>
				</a>
				<p>All messages provided in this library can be localized by simply assigning new values to class variables of <code>Exception</code>. These messages all start with the <code>Err</code> prefix in their names.</p>
				<p>There are samples of translations of two written scripts of Chinese. These samples are provided in TypeScript forms, and their final JavaScript forms.</p>
				<a href="#translations" id="translations" style="color: inherit; text-decoration: none;">
					<h4><code>/translations</code></h4>
				</a>
				<p>The two translations here are to demonstrate the final form that will be part of this library&#39;s distribution. So in case any of you are interested in contributing to this library, this is the place to submit your translations. To use these translations, simply require it after the main import.</p>
				<pre><code class="language-js"><span class="hljs-keyword">const</span> XmlPatch = <span class="hljs-built_in">require</span>(<span class="hljs-string">'xml-patch'</span>);

<span class="hljs-comment">// must load after xml-patch</span>
<span class="hljs-built_in">require</span>(<span class="hljs-string">'xml-patch/translations/zh_chs'</span>);

<span class="hljs-comment">// or load your own translation .js file</span>
<span class="hljs-built_in">require</span>(<span class="hljs-string">'./path/to/your/translation'</span>);

<span class="hljs-comment">// do your stuff.</span></code></pre>
				<a href="#srctranslations" id="srctranslations" style="color: inherit; text-decoration: none;">
					<h4><code>/src/translations</code></h4>
				</a>
				<p>The two translations here are to demonstrate how you can write your own ad-hoc translations in source tree. Please don&#39;t use the two files in this directory directly in your code.</p>
				<p>To use these translations, simply:</p>
				<pre><code class="language-ts"><span class="hljs-keyword">import</span> { Patch } <span class="hljs-keyword">from</span> <span class="hljs-string">'xml-patch'</span>;

<span class="hljs-comment">// you can use the js version just the same way</span>
<span class="hljs-built_in">require</span>(<span class="hljs-string">'xml-patch/translations/zh_cht'</span>);

<span class="hljs-comment">// or make and load your own translation .ts file</span>
<span class="hljs-keyword">import</span> <span class="hljs-string">'./path/to/your/translation'</span>;

<span class="hljs-comment">// do your stuff.</span></code></pre>
				<p>Here&#39;s a snipped version of source code:</p>
				<pre><code class="language-ts"><span class="hljs-keyword">import</span> { Exception } <span class="hljs-keyword">from</span> <span class="hljs-string">'xml-patch'</span>;

Exception.ErrDirective = <span class="hljs-string">'Your take on this'</span>;

Exception.ErrEncoding = <span class="hljs-string">'Just translate it already'</span>;

<span class="hljs-comment">// ... more translation go on ...</span></code></pre>
				<a href="#test-data-set" id="test-data-set" style="color: inherit; text-decoration: none;">
					<h2>Test data set</h2>
				</a>
				<p>There are some XML files in the <code>tests/data</code> directory, which are used for unit testing. They mainly come from two sources:</p>
				<ol>
					<li>Samples from the <a href="https://tools.ietf.org/html/rfc5261">RFC 5261</a> document.</li>
					<li>Samples from the <a href="http://diffxml.sourceforge.net/">diffxml</a> project.</li>
				</ol>
				<a href="#building" id="building" style="color: inherit; text-decoration: none;">
					<h2>Building</h2>
				</a>
				<p>This package uses webpack. Just in case anyone gets curious, don&#39;t use fire up <code>tsc</code>. I couldn&#39;t get it working yet. <code>tsc</code> keeps complaining about <code>xmldom-ts</code>.</p>
			</div>
			<footer class="with-border-bottom">
				<div class="tsd-legend-group">
					<ul class="tsd-legend">
						<li class="tsd-is-inherited"><span class="tsd-kind-icon">Inherited</span></li>
						<li class="tsd-is-protected"><span class="tsd-kind-icon">Protected</span></li>
						<li class="tsd-is-private"><span class="tsd-kind-icon">Private</span></li>
						<li class="tsd-is-static"><span class="tsd-kind-icon">Static</span></li>
					</ul>
					<ul class="tsd-legend">
						<li class="tsd-kind-module"><span class="tsd-kind-icon">Module</span></li>
						<li class="tsd-kind-object-literal"><span class="tsd-kind-icon">Object</span></li>
						<li class="tsd-kind-property"><span class="tsd-kind-icon">Property</span></li>
					</ul>
					<ul class="tsd-legend">
						<li class="tsd-kind-function"><span class="tsd-kind-icon">Function</span></li>
						<li class="tsd-kind-variable"><span class="tsd-kind-icon">Variable</span></li>
						<li class="tsd-kind-index-signature"><span class="tsd-kind-icon">Index</span></li>
					</ul>
					<ul class="tsd-legend">
						<li class="tsd-kind-type-alias"><span class="tsd-kind-icon">Type</span></li>
						<li class="tsd-kind-class"><span class="tsd-kind-icon">Class</span></li>
						<li class="tsd-kind-interface"><span class="tsd-kind-icon">Interface</span></li>
					</ul>
					<ul class="tsd-legend">
						<li class="tsd-kind-enum"><span class="tsd-kind-icon">Enum</span></li>
						<li class="tsd-kind-constructor"><span class="tsd-kind-icon">Constructor</span></li>
						<li class="tsd-kind-accessor"><span class="tsd-kind-icon">Getter/Setter</span></li>
					</ul>
				</div>
			</footer>
			<div>Made with ❤️ by <a href="https://github.com/pirix-gh/eledoc" target="_blank">pirix-gh</a>. Documentation generated by <a href="http://typedoc.org/" target="_blank">TypeDoc.</a></div>
		</div>
	</div>
</div>
<div class="overlay"></div>
<script src="assets/js/main.js"></script>
<script>if (location.protocol == 'file:') document.write('<script src="assets/js/search.js"><' + '/script>');</script>
</body>
</html>